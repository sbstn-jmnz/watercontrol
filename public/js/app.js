!function(){"use strict";function configFn($httpProvider,$stateProvider,$urlRouterProvider,usSpinnerConfigProvider,$breadcrumbProvider,APP_SETTINGS){$httpProvider.interceptors.push("ApiInterceptors"),usSpinnerConfigProvider.setTheme("mainSpinner",APP_SETTINGS.SPINNER_SETTINGS),$urlRouterProvider.otherwise("/login"),$stateProvider.state("measures",{url:"/","abstract":!0,templateUrl:"assets/views/main/main.html",controller:"MainController",controllerAs:"main",ncyBreadcrumb:{label:"Mediciones"},resolve:{UserLogged:["AuthService","$cookieStore","$state",function(AuthService,$cookieStore,$state){var userLogged=AuthService.getUser(),tokenCookie=$cookieStore.get("auth_token");return userLogged?AuthService.getUser():AuthService.login({auth_token:tokenCookie}).then(AuthService.getUser)["catch"](function(err){$state.go("login")})}]}}),$breadcrumbProvider.setOptions({template:"bootstrap3",includeAbstract:!0})}function runFn($state,$rootScope,$cookieStore){function stateTransitioned(e,toState,toParams,fromState,fromParams){var invalidStarterStates=["measures.plot","measures.plotMeasures"],userLogged=!!$cookieStore.get("auth_token");userLogged?(fromState.name&&"measures.plot"===toState.name&&($rootScope.actualPlotNavigation=toParams.id),fromState.name||-1===invalidStarterStates.indexOf(toState.name)||$state.go("measures.sectors")):$state.go("login")}$rootScope.$on("$stateChangeSuccess",stateTransitioned)}angular.module("MedicionAguaAdmin",["ngAnimate","ui.router","ngCookies","angularSpinner","ngResource","ngMessages","gp.rutValidator","ncy-angular-breadcrumb","ui.select","ngSanitize"]),angular.module("MedicionAguaAdmin").constant("APP_SETTINGS",{NAVBAR_SETTINGS:{templateUrl:"assets/views/navbar/navbar.html",controller:"NavbarController",controllerAs:"navbar"},SPINNER_SETTINGS:{color:"#FFFFFF",radius:30,width:8,length:16,top:"30%"},BASE_URL:"http://54.186.177.252:3000/webapp",PROFILE_ROLES:{ADMIN:"admin",SUPERADMIN:"superadmin"},MEASURE_PROCESSES_STATUS:{ACTIVE:"active",CLOSES:"closed"}}),angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$httpProvider","$stateProvider","$urlRouterProvider","usSpinnerConfigProvider","$breadcrumbProvider","APP_SETTINGS"],angular.module("MedicionAguaAdmin").run(runFn),runFn.$inject=["$state","$rootScope","$cookieStore"]}(),function(){"use strict";function Controller($state){}angular.module("MedicionAguaAdmin").controller("HomeController",Controller),Controller.$inject=["$state"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){$stateProvider.state("measures.home",{url:"home",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/home/home.html",controller:"HomeController",controllerAs:"home"}},ncyBreadcrumb:{label:"Home page"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}(),function(){"use strict";function Controller($state,AuthService){function login(_user){AuthService.login(_user).then(function(){$state.go("measures.home")})["catch"](function(err){alert(err.message||"Datos inválidos")})}var vm=this;vm.user={email:"",password:""},vm.loginGo=login}angular.module("MedicionAguaAdmin").controller("LoginController",Controller),Controller.$inject=["$state","AuthService"]}(),function(){"use strict";function configFn($stateProvider){$stateProvider.state("login",{url:"/login",templateUrl:"assets/views/login/login.html",controller:"LoginController",controllerAs:"login"})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider"]}(),function(){"use strict";function Service($resource,$cookieStore,APP_SETTINGS){function login(_userCredentials){var userResource=new self.sessionResource(_userCredentials);return userResource.$save().then(setUser)}function getUser(){return user}function setUser(_userResponse){$cookieStore.put("auth_token",_userResponse.auth_token),user=_userResponse.toJSON(),user.condoSelected=user.condos_assigned[0]}function setSelectedCondo(_selectedCondo){user.condosSelected=_selectedCondo}var self=this,user=null;self.sessionResource=$resource(APP_SETTINGS.BASE_URL+"/sessions"),self.login=login,self.getUser=getUser,self.setSelectedCondo=setSelectedCondo}angular.module("MedicionAguaAdmin").service("AuthService",Service),Service.$inject=["$resource","$cookieStore","APP_SETTINGS"]}(),function(){"use strict";function Controller($scope){function openSpinner(){vm.spinnerOpened=!0}function closeSpinner(){vm.spinnerOpened=!1}var vm=this;vm.spinnerOpened=!1,$scope.$on("open:spinner",openSpinner),$scope.$on("close:spinner",closeSpinner)}angular.module("MedicionAguaAdmin").controller("MainController",Controller),Controller.$inject=["$scope"]}(),function(){"use strict";function factory($q,$cookieStore){function handleRequest(request){var loginRegex=/\/sessions/,userToken=$cookieStore.get("auth_token");return request.url.match(loginRegex)||(request.headers.Authorization="Token token="+userToken),request}function handleError(rejection){return $q.reject(rejection)}var service={request:handleRequest,responseError:handleError};return service}angular.module("MedicionAguaAdmin").factory("ApiInterceptors",factory),factory.$inject=["$q","$cookieStore"]}(),function(){"use strict";function Controller($scope,$state,SectorsService,UsersResolve,SectorsResolve){function checkedSectors(_userId){vm.sectorsList.map(function(sector){return sector.checked=sector.user_id===_userId,sector.disabled=sector.user_id!==_userId&&null!==sector.user_id,sector})}function editRelation(_sector){_sector.user_id=_sector.checked?vm.selectedUserId:null}function saveRelations(_sectors){vm.unassignedSectors=_sectors.filter(function(sector){return!sector.user_id}),vm.unassignedSectors.length?alert("ERROR: Los siguientes sectores no tienen usuario asignado: "+vm.unassignedSectors.map(function(s){return s.name}).join(",")):SectorsService.saveSectors(_sectors).then(function(){alert("Asignaciones a sectores guardadas exitosamente")})}var vm=this;vm.usersList=angular.copy(UsersResolve),vm.sectorsList=angular.copy(SectorsResolve),vm.unassignedSectors=[],vm.selectedUserId=vm.usersList[0].id,vm.checkedSectors=checkedSectors,vm.editRelation=editRelation,vm.saveRelations=saveRelations,$scope.$on("change:condo",function(){$state.reload($state.current.name)}),vm.checkedSectors(vm.selectedUserId)}angular.module("MedicionAguaAdmin").controller("AssignSectorController",Controller),Controller.$inject=["$scope","$state","SectorsService","UsersResolve","SectorsResolve"]}(),function(){"use strict";function controller($state,APP_SETTINGS,ChangeParametersService){function saveChanges(newParams){ChangeParametersService.postParams(newParams).then(function(response){$state.go("measures.measureProcesses")})}var vm=this;vm.saveChanges=saveChanges}angular.module("MedicionAguaAdmin").controller("ChangeChargeParametersController",controller),controller.$inject=["$state","APP_SETTINGS","ChangeParametersService"]}(),function(){"use strict";function Controller(){}angular.module("MedicionAguaAdmin").controller("ChangePasswordController",Controller),Controller.$inject=[]}(),function(){"use strict";function Controller($rootScope,$filter,$timeout,CondosResolve,PeriodsResolve,ConfigurationResolve){var vm=this;vm.condosList=angular.copy(CondosResolve),vm.periodsList=angular.copy(PeriodsResolve),vm.configuration=angular.copy(ConfigurationResolve),vm.selectedCondo=vm.condosList[0].id}angular.module("MedicionAguaAdmin").controller("MaintenanceController",Controller),Controller.$inject=["$rootScope","$filter","$timeout","CondosResolve","PeriodsResolve","ConfigurationResolve"]}(),function(){"use strict";function Controller($scope,$state,MeasureProcessesResolve,MeasureProcessesService,APP_SETTINGS,ChargeParametersResolve){function checkActiveProcesses(_processes){return!(_processes.filter(function(p){return p.status===APP_SETTINGS.MEASURE_PROCESSES_STATUS.ACTIVE}).length>0)}function initProcess(){MeasureProcessesService.initProcess().then(function(updatedProcesses){vm.measureProcesses=updatedProcesses,vm.closed=checkActiveProcesses(vm.measureProcesses)})}function closeProcess(){var targetProcess=vm.measureProcesses.filter(function(p){return p.status===APP_SETTINGS.MEASURE_PROCESSES_STATUS.ACTIVE})[0];MeasureProcessesService.closeProcess(targetProcess.id).then(function(updatedProcesses){vm.measureProcesses=updatedProcesses,vm.closed=checkActiveProcesses(vm.measureProcesses)})}var vm=this;vm.measureProcesses=angular.copy(MeasureProcessesResolve),vm.closed=checkActiveProcesses(vm.measureProcesses),vm.chargeparameters=angular.copy(ChargeParametersResolve),vm.initProcess=initProcess,vm.closeProcess=closeProcess,$scope.$on("change:condo",function(){$state.reload($state.current.name)})}angular.module("MedicionAguaAdmin").controller("MeasureProcessesController",Controller),Controller.$inject=["$scope","$state","MeasureProcessesResolve","MeasureProcessesService","APP_SETTINGS","ChargeParametersResolve"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){$stateProvider.state("measures.maintenance",{url:"maintenance",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/maintenance/maintenance.html",controller:"MaintenanceController",controllerAs:"maintenance",resolve:{CondosResolve:["PlotsService",function(PlotsService){return PlotsService.getCondos()}],PeriodsResolve:["ConfigurationService",function(ConfigurationService){return ConfigurationService.getPeriods()}],ConfigurationResolve:["ConfigurationService",function(ConfigurationService){return ConfigurationService.getConfiguration()}]}}},ncyBreadcrumb:{label:"Mantención"}}).state("measures.measureProcesses",{url:"measureProcesses",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/maintenance/measureProcesses.html",controller:"MeasureProcessesController",controllerAs:"measureProcesses",resolve:{MeasureProcessesResolve:["MeasureProcessesService",function(MeasureProcessesService){return MeasureProcessesService.getConfig()}],ChargeParametersResolve:["ChangeParametersService",function(ChangeParametersService){return ChangeParametersService.getParams()}]}}},ncyBreadcrumb:{label:"Configurar Mediciones"}}).state("measures.assignsector",{url:"assignsector",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/maintenance/assignsector.html",controller:"AssignSectorController",controllerAs:"assignsector",resolve:{UsersResolve:["UsersService",function(UsersService){return UsersService.getUsers()}],SectorsResolve:["SectorsService",function(SectorsService){return SectorsService.getSectors()}]}}},ncyBreadcrumb:{label:"Asignar Sector"}}).state("measures.changepassword",{url:"changepassword",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/maintenance/changepassword.html",controller:"ChangePasswordController",controllerAs:"changepassword"}},ncyBreadcrumb:{label:"Cambiar Contraseña"}}).state("measures.changechargeparameters",{url:"changeparameters",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/maintenance/changechargeparameters.html",controller:"ChangeChargeParametersController",controllerAs:"changeparameters"}},ncyBreadcrumb:{label:"Cambiar Parametros de cobro"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}(),function(){"use strict";function service(APP_SETTINGS,$resource,AuthService){function postParams(newParams){var selectedCondo=AuthService.getUser().condoSelected;return self.changeParametersResource.update({condoId:selectedCondo.id,option:"update"},newParams).$promise}function getParams(){var selectedCondo=AuthService.getUser().condoSelected;return self.changeParametersResource.get({condoId:selectedCondo.id}).$promise}var self=this;self.changeParametersResource=$resource(APP_SETTINGS.BASE_URL+"/condos/:condoId/charge_parameters/:option",{condoId:"@condoId",option:"@option"},{update:{method:"PATCH"}}),self.postParams=postParams,self.getParams=getParams}angular.module("MedicionAguaAdmin").service("ChangeParametersService",service),service.$inject=["APP_SETTINGS","$resource","AuthService"]}(),function(){"use strict";function service($q,APP_SETTINGS,$resource,AuthService){function getConfig(){var selectedCondo=AuthService.getUser().condoSelected;return self.confMeasuresResource.query({condoId:selectedCondo.id}).$promise}function initProcess(){var selectedCondo=AuthService.getUser().condoSelected,process=new self.confMeasuresResource({});return process.$save({condoId:selectedCondo.id}).then(getConfig)}function closeProcess(_processId){var selectedCondo=AuthService.getUser().condoSelected,process=new self.confMeasuresResource({});return process.$save({id:_processId,condoId:selectedCondo.id,option:"close"}).then(getConfig)}var self=this;self.confMeasuresResource=$resource(APP_SETTINGS.BASE_URL+"/condos/:condoId/measure_processes/:id/:option",{id:"@id",condoId:"@condoId",option:"@option"}),self.getConfig=getConfig,self.initProcess=initProcess,self.closeProcess=closeProcess}angular.module("MedicionAguaAdmin").service("MeasureProcessesService",service),service.$inject=["$q","APP_SETTINGS","$resource","AuthService"]}(),function(){"use strict";function Controller(){function addmeter(_meter){}var vm=this;vm.meterstatus=[{label:"Activo",value:"ACTIVE"},{label:"Inactivo",value:"INACTIVE"}],vm.selectedstatus=vm.meterstatus[0].value,vm.addmeter=addmeter}angular.module("MedicionAguaAdmin").controller("CreateMeterController",Controller),Controller.$inject=[]}(),function(){"use strict";function Controller(){var vm=this;vm.metersList=[{nsitio:5,ubicacion:"Campo Mar",propietario:"Orlando Diaz Romero",anterior:1491,actual:1546,consumototal:55,nmedidor:50354,estadomedidor:"Activo"},{nsitio:26,ubicacion:"Campo Mar",propietario:"Macarena Renard Merino",anterior:1496,actual:1551,consumototal:55,nmedidor:53514,estadomedidor:"Activo"},{nsitio:6,ubicacion:"Campo Mar",propietario:"Patricia Nuñez",anterior:2236,actual:2237,consumototal:1,nmedidor:45213,estadomedidor:"Activo"},{nsitio:38,ubicacion:"Campo Mar",propietario:"Graciela Mateo Sepulveda",anterior:1145,actual:1186,consumototal:41,nmedidor:42351,estadomedidor:"Activo"}]}angular.module("MedicionAguaAdmin").controller("MetersController",Controller),Controller.$inject=[]}(),function(){"use strict";function Controller($stateParams){function unsetMeter(){}var vm=this;vm.unsetmeter=unsetMeter,vm.meterId=$stateParams}angular.module("MedicionAguaAdmin").controller("UnsetMeterController",Controller),Controller.$inject=["$stateParams"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){var mainViewConfig={navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/meters/meters.html",controller:"MetersController",controllerAs:"meters",resolve:{}}},unsetmeterViewConf={navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/meters/unsetmeter.html",controller:"UnsetMeterController",controllerAs:"unsetmeter",resolve:{}}},createmeterViewConf={navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/meters/createmeter.html",controller:"CreateMeterController",controllerAs:"createmeter",resolve:{}}};$stateProvider.state("measures.meters",{url:"meters",views:mainViewConfig,ncyBreadcrumb:{label:"Medidores"}}).state("measures.unsetmeter",{url:"unsetmeter/:meterId",views:unsetmeterViewConf,ncyBreadcrumb:{label:"Dar de baja medidor"}}).state("measures.createmeter",{url:"createmeter",views:createmeterViewConf,ncyBreadcrumb:{label:"Crear un medidor"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}(),function(){"use strict";function Service(APP_SETTINGS,$resource){APP_SETTINGS.BASE_URL+"/meters/:idmeter"}angular.module("MedicionAguaAdmin").controller("MetersService",Service),Service.$inject=["APP_SETTINGS","$resource"]}(),function(){"use strict";function Controller($rootScope,$state,AuthService,UserLogged,APP_SETTINGS){function checkState(_statename){return $state.is(_statename)}function changeCondo(_condoId){vm.userLogged.condoSelected=vm.userLogged.condos_assigned.filter(function(condo){return condo.id===_condoId})[0],-1!==["measures.sectors","measures.assignsector","measures.measureProcesses"].indexOf($state.current.name)&&$rootScope.$broadcast("change:condo",{condoId:_condoId})}var vm=this;vm.checkState=checkState,vm.userLogged=UserLogged,vm.showCondos=vm.userLogged.role===APP_SETTINGS.PROFILE_ROLES.SUPERADMIN,vm.selectedCondo=vm.userLogged.condoSelected,vm.changeCondo=changeCondo}angular.module("MedicionAguaAdmin").controller("NavbarController",Controller),Controller.$inject=["$rootScope","$state","AuthService","UserLogged","APP_SETTINGS"]}(),function(){"use strict";function Controller(PlotMeausures){var vm=this;vm.plotMeasures=angular.copy(PlotMeausures)}angular.module("MedicionAguaAdmin").controller("PlotMeasuresController",Controller),Controller.$inject=["PlotMeausures"]}(),function(){"use strict";function Controller($state,PlotResolve){function goPlotMeasures(_meterId){$state.go("measures.plotMeasures",{meterId:_meterId})}function goUnsetMeter(_meterId){$state.go("measures.unsetmeter",{meterId:_meterId})}var vm=this;vm.plotSelected=angular.copy(PlotResolve),vm.goPlotMeasures=goPlotMeasures,vm.goUnsetMeter=goUnsetMeter}angular.module("MedicionAguaAdmin").controller("PlotController",Controller),Controller.$inject=["$state","PlotResolve"]}(),function(){"use strict";function Controller($rootScope,$state,$filter,CondosResolve,CondoSelected,CondosService){function loadSectors(_condoId){$rootScope.$broadcast("open:spinner"),CondosService.getCondo(_condoId).then(function(response){var condo=response.toJSON();vm.condoSelected=condo,vm.sectorsList=vm.condoSelected.sectors,vm.selectedSectorId=vm.sectorsList[0].id,vm.plotsList=vm.sectorsList[0].plots,$rootScope.$broadcast("close:spinner")})}function loadPlots(_sectorId){vm.plotsList=pickPlot(_sectorId)}function pickPlot(_sectorId){return vm.sectorsList.filter(function(sector){return sector.id===_sectorId})[0].plots}function search(_searchString){vm.plotsList=_searchString?$filter("filter")(vm.plotsList,{plot_number:_searchString}):pickPlot(vm.selectedSectorId)}function plotGo(_plotId){$state.go("measures.plot",{id:_plotId})}var vm=this;vm.plotsOwners=[{rut:"1.222.333-4",nombre:"Viviana Costa Gonzales"},{rut:"2.333.444-5",nombre:"Patricio Rojas Albornoz"},{rut:"3.444.555-6",nombre:"Luis Bastidas Fenr"},{rut:"4.555.666-7",nombre:"Omar Reyes Quijada"}],vm.condosList=angular.copy(CondosResolve),vm.condoSelected=angular.copy(CondoSelected),vm.sectorsList=vm.condoSelected.sectors,vm.selectedCondoId=vm.condoSelected.id,vm.selectedSectorId=vm.sectorsList[0].id,vm.plotsList=vm.sectorsList[0].plots,vm.loadSectors=loadSectors,vm.loadPlots=loadPlots,vm.searchPlot=search,vm.plotGo=plotGo}angular.module("MedicionAguaAdmin").controller("PlotsOwnersController",Controller),Controller.$inject=["$rootScope","$state","$filter","CondosResolve","CondoSelected","CondosService"]}(),function(){"use strict";function Controller($scope,$rootScope,$state,$filter,PlotResolve){var vm=this;vm.plotsOwners=[{id:1,rut:"1.222.333-4",nombre:"Viviana Costa Gonzales"},{id:10,rut:"2.333.444-5",nombre:"Patricio Rojas Albornoz"},{id:3,rut:"3.444.555-6",nombre:"Luis Bastidas Fenr"},{id:4,rut:"4.555.666-7",nombre:"Omar Reyes Quijada"},{id:2,rut:"16.299.222-8",nombre:"Gonzalo"},{id:2,rut:"15.316.349-9",nombre:"Seba"},{id:2,rut:"1.111.111-1",nombre:"Jenny"}],vm.selectedPlotId=$state.params.id,vm.plot=angular.copy(PlotResolve),vm.selected={value:vm.plotsOwners[vm.plotsOwners.map(function(e){return e.rut}).indexOf(vm.plot.owner.rut)]}}angular.module("MedicionAguaAdmin").controller("SetPlotsOwnersController",Controller),Controller.$inject=["$scope","$rootScope","$state","$filter","PlotResolve"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){var mainViewConf={templateUrl:"assets/views/plots/plot.html",controller:"PlotController",controllerAs:"plot",resolve:{PlotResolve:["PlotsService","$stateParams",function(PlotsService,$stateParams){return PlotsService.getPlot($stateParams.id).then(function(plot){return plot.toJSON()})}]}},plotMeasuresConf={templateUrl:"assets/views/plots/plotMeasures.html",controller:"PlotMeasuresController",controllerAs:"plotMeasures",resolve:{PlotMeausures:["PlotsMeasureService","$stateParams",function(PlotsMeasureService,$stateParams){return PlotsMeasureService.getPlotMeasures($stateParams.meterId).then(function(plot){return plot.toJSON()})}]}},plotsOwnersConf={templateUrl:"assets/views/plots/plotsowners.html",controller:"PlotsOwnersController",controllerAs:"plotsowners",resolve:{CondosResolve:["CondosService",function(CondosService){return CondosService.getCondos()}],CondoSelected:["CondosResolve","CondosService",function(CondosResolve,CondosService){var condoId=CondosResolve[0].id;return CondosService.getCondo(condoId).then(function(response){return response.toJSON()})}]}},setPlotOwnersConf={templateUrl:"assets/views/plots/setplotowners.html",controller:"SetPlotsOwnersController",controllerAs:"setplotsowners",resolve:{PlotResolve:["PlotsService","$stateParams",function(PlotsService,$stateParams){return PlotsService.getPlot($stateParams.id).then(function(response){return response.toJSON()})}]}};$stateProvider.state("measures.plot",{url:"plots/:id",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:mainViewConf},ncyBreadcrumb:{parent:"measures.sectors",label:"Parcela Nº {{actualPlotNavigation}}"}}).state("measures.plotsowners",{url:"plotsowners",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:plotsOwnersConf},ncyBreadcrumb:{label:"Asignar dueños de parcelas"}}).state("measures.setplotowners",{url:"setplotowners/:id",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:setPlotOwnersConf},ncyBreadcrumb:{parent:"measures.plotsowners",label:"Dueño parcela N°{{setplotsowners.selectedPlotId}}"}}).state("measures.plotMeasures",{url:"meters/:meterId",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:plotMeasuresConf},ncyBreadcrumb:{parent:"measures.plot",label:"Mediciones"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}(),function(){"use strict";function service($q,APP_SETTINGS,$resource){function getPlotMeasures(_meterId){return self.metersResource.get({id:_meterId}).$promise}var self=this;self.metersResource=$resource(APP_SETTINGS.BASE_URL+"/meters/:id",{id:"@id"}),self.getPlotMeasures=getPlotMeasures}angular.module("MedicionAguaAdmin").service("PlotsMeasureService",service),service.$inject=["$q","APP_SETTINGS","$resource"]}(),function(){"use strict";function service($q,APP_SETTINGS,$resource){function rejectResponse(){var defer=$q.defer();return defer.reject({error:"Falta id para el endpoint /plots."}),defer.promise}function getPlot(_plotId){return _plotId?self.plotsResource.get({id:_plotId}).$promise:rejectResponse()}var self=this;self.plotsResource=$resource(APP_SETTINGS.BASE_URL+"/plots/:id",{id:"@id"}),self.getPlot=getPlot}angular.module("MedicionAguaAdmin").service("PlotsService",service),service.$inject=["$q","APP_SETTINGS","$resource"]}(),function(){"use strict";function Controller($rootScope,$scope,$state,$filter,CondoSelected,CondosService){function loadSectors(event,args){vm.selectedCondoId=args?args.condoId:vm.selectedCondoId,$rootScope.$broadcast("open:spinner"),CondosService.getCondo(vm.selectedCondoId).then(function(response){var condo=response.toJSON();vm.condoSelected=condo,vm.sectorsList=vm.condoSelected.sectors,vm.selectedSectorId=vm.sectorsList[0].id,vm.plotsList=vm.sectorsList[0].plots,$rootScope.$broadcast("close:spinner")})}function loadPlots(_sectorId){vm.plotsList=pickPlot(_sectorId)}function pickPlot(_sectorId){return vm.sectorsList.filter(function(sector){return sector.id===_sectorId})[0].plots}function search(_searchString){vm.plotsList=_searchString?$filter("filter")(vm.plotsList,{plot_number:_searchString}):pickPlot(vm.selectedSectorId)}function plotGo(_plotId){$state.go("measures.plot",{id:_plotId})}var vm=this;vm.condoSelected=angular.copy(CondoSelected),vm.sectorsList=vm.condoSelected.sectors,vm.selectedCondoId=vm.condoSelected.id,vm.selectedSectorId=vm.sectorsList[0].id,vm.plotsList=vm.sectorsList[0].plots,vm.loadSectors=loadSectors,vm.loadPlots=loadPlots,vm.searchPlot=search,vm.plotGo=plotGo,$scope.$on("change:condo",loadSectors)}angular.module("MedicionAguaAdmin").controller("SectorsController",Controller),Controller.$inject=["$rootScope","$scope","$state","$filter","CondoSelected","CondosService"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){var mainViewConf={templateUrl:"assets/views/sectors/sectors.html",controller:"SectorsController",controllerAs:"sectors",resolve:{CondoSelected:["AuthService","CondosService",function(AuthService,CondosService){var condoId=AuthService.getUser().condoSelected.id;return CondosService.getCondo(condoId).then(function(response){return response.toJSON()})}]}};$stateProvider.state("measures.sectors",{url:"sectors",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:mainViewConf},ncyBreadcrumb:{label:"Parcelas"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}(),function(){"use strict";function service(APP_SETTINGS,$resource){function getCondos(){return self.condosResource.query().$promise}function getCondo(_id){return self.condosResource.get({id:_id}).$promise}var self=this,condosResourceUrl=APP_SETTINGS.BASE_URL+"/condos/:id";self.condosResource=$resource(condosResourceUrl,{id:"@id"}),self.getCondos=getCondos,self.getCondo=getCondo}angular.module("MedicionAguaAdmin").service("CondosService",service),service.$inject=["APP_SETTINGS","$resource"]}(),function(){"use strict";function service(AuthService,APP_SETTINGS,$resource){function getSectors(){var selectedCondo=AuthService.getUser().condoSelected;return self.sectorsResource.query({condoId:selectedCondo.id}).$promise}function saveSectors(_sectors){var selectedCondo=AuthService.getUser().condoSelected;return self.sectorsResource.update({condoId:selectedCondo.id},{sectors:_sectors}).$promise}var self=this,sectorsResourceUrl=APP_SETTINGS.BASE_URL+"/condos/:condoId/sectors/:id";self.sectorsResource=$resource(sectorsResourceUrl,{condoId:"@condoId",id:"@id"},{update:{method:"PUT"}}),self.getSectors=getSectors,self.saveSectors=saveSectors}angular.module("MedicionAguaAdmin").service("SectorsService",service),service.$inject=["AuthService","APP_SETTINGS","$resource"]}(),angular.module("MedicionAguaAdmin").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("assets/views/home/home.html",'<div ncy-breadcrumb="ncy-breadcrumb"></div>\n<div class="container well">\n  <h3>Bienvenid@ Admin</h3>\n  <div class="row">\n    <div class="col-xs-6"> </div>\n    <div class="col-xs-6">\n      <div class="panel panel-default">\n        <div class="panel-heading"><b>Estadística general</b></div>\n        <div class="panel-body"><span>Estado de mediciones:</span>\n          <div class="progress">\n            <div role="progressbar" aria-valuenow="76" aria-valuemin="0" aria-valuemax="100" style="width: 76%" class="progress-bar">76%</div>\n          </div>\n          <hr><span>Aumento en consumo:</span>\n          <div class="progress">\n            <div role="progressbar" aria-valuenow="16" aria-valuemin="0" aria-valuemax="100" style="width: 16%" class="progress-bar">16%</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/login/login.html",'<div class="container login-container">\n  <div class="row">\n    <div class="login-img col-xs-12 col-sm-12 col-md-7 col-lg-8 hidden-xs hidden-sm">\n    </div>\n    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">\n      <div class="panel panel-default">\n        <div style="font-size:16px" class="panel-heading">Login</div>\n        <div class="panel-body">\n          <form name="loginForm" class="form-signin"><span id="reauth-email" class="reauth-email"></span>\n            <input id="inputEmail" type="email" placeholder="Email" ng-model="login.user.email" required="required" class="form-control">\n            <input id="inputPassword" type="password" placeholder="Password" ng-model="login.user.password" required="required" class="form-control">\n            \n            <div class="center-block forgot-password"><a>¿Olvidó su Password?</a></div>\n          </form>\n        </div>\n        <div class="panel-footer text-right">\n          <button type="submit" ng-disabled="loginForm.$invalid" ng-click="login.loginGo(login.user)" class="btn btn-lg btn-primary btn-block btn-signin">Ingresar</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/main/main.html",'<div ui-view="navbar" class="app-navbar"></div>\n<div ui-view="main" class="app-section"></div>\n<div ng-class="{\'opened\': main.spinnerOpened}" class="main-spinner"><span us-spinner="us-spinner" spinner-theme="mainSpinner"></span>\n  <h1>Cargando Información</h1>\n</div>'),$templateCache.put("assets/views/maintenance/assignsector.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Asignar sector</div>\n    <div class="panel-body">\n      <form>\n        <div class="col-xs-6">\n          <label>Seleccion Lector</label>\n          <select ng-options="user.id as user.name for user in assignsector.usersList" ng-model="assignsector.selectedUserId" ng-change="assignsector.checkedSectors(assignsector.selectedUserId)" class="form-control"></select>\n        </div>\n        <div class="col-xs-6">\n          <label>Seleccione Sectores</label>            \n          <div class="well">\n            <ul class="list-group checked-list-box">\n              <li ng-repeat="sector in assignsector.sectorsList track by sector.id" ng-class="{disabled: sector.disabled}" class="list-group-item">\n                <input type="checkbox" ng-model="sector.checked" ng-change="assignsector.editRelation(sector)" ng-disabled="sector.disabled"><span ng-bind="sector.name"></span>\n              </li>\n            </ul>\n          </div>\n          <div class="row">\n            <div class="col-xs-3 col-xs-offset-9">\n              <button ng-click="assignsector.saveRelations(assignsector.sectorsList)" class="btn btn-success">Guardar</button>\n            </div>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/maintenance/changechargeparameters.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Cambiar parámetros de cobro</div>\n    <div class="panel-body">\n      <form name="changechargeparametersForm">\n        <div class="form-group">\n          <label>Cargo fijo:</label>\n          <input type="number" ng-model="changeparameters.newParams.fixed" class="form-control">\n        </div>\n        <div class="form-group">\n          <label>Valor m3:</label>\n          <input type="number" ng-model="changeparameters.newParams.normal_price" class="form-control">\n        </div>\n        <div class="form-group">\n          <label>Valor sobreconsumo:</label>\n          <input type="number" ng-model="changeparameters.newParams.over_consumption_price" class="form-control">\n        </div>\n        <div class="form-group text-right">\n          <button ng-click="changeparameters.saveChanges(changeparameters.newParams)" class="btn btn-default">Guardar</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/maintenance/changepassword.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Cambiar contraseña</div>\n    <div class="panel-body">\n      <form>\n        <div class="form-group">\n          <label>Ingrese contraseña actual</label>\n          <input type="password" class="form-control">\n        </div>\n        <div class="form-group">\n          <label>Ingrese nueva contraseña</label>\n          <input type="password" class="form-control">\n        </div>\n        <div class="form-group">\n          <label>Repita nueva contraseña</label>\n          <input type="password" class="form-control">\n        </div>\n        <div class="form-group text-right">\n          <button type="submit" class="btn btn-default">Aceptar</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>'),
$templateCache.put("assets/views/maintenance/confmeasures.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Mediciones</div>\n    <div class="panel-body">\n      <form>\n        <div class="form-group">\n          <label>Establecer el cargo fijo</label>\n          <input type="password" class="form-control">\n        </div>\n        <div class="row">\n          <div class="col-xs-4">\n            <label>Periodo de cobro</label>\n          </div>\n          <div class="col-xs-4">\n            <div class="form-group text-center">\n              <label>Desde</label>\n              <input type="text" class="form-control">\n            </div>\n          </div>\n          <div class="col-xs-4">\n            <div class="form-group text-center">\n              <label>Hasta</label>\n              <input type="text" class="form-control">\n            </div>\n          </div>\n        </div>\n        <div class="form-group text-right">\n          <button type="submit" class="btn btn-default">Guardar</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/maintenance/maintenance.html",'<div ncy-breadcrumb=""></div>\n<div class="row maintenance-container">\n  <div class="col-sm-12 col-lg-8 col-lg-offset-2">\n    <div class="condos-container col-sm-4 col-lg-4">\n      <div class="form-group">\n        <label>Seleccione Condominio</label>\n        <select ng-options="condo.id as condo.name for condo in maintenance.condosList" ng-model="maintenance.selectedCondo" class="form-control"></select>\n      </div>\n    </div>\n    <div class="condos-container col-sm-4 col-lg-4">\n      <div class="form-group">\n        <label>Periodo</label>\n        <select class="form-control"></select>\n      </div>\n    </div>\n  </div>\n  <div class="col-sm-12 col-lg-8 col-lg-offset-2">\n    <form class="condos-container col-sm-4 col-lg-4">\n      <h3>Configuración</h3>\n      <div class="form-group">\n        <label>Valor sobreconsumo</label>\n        <input type="text" class="form-control">\n      </div>\n      <div class="form-group">\n        <label>Cargo fijo</label>\n        <input type="text" class="form-control">\n      </div>\n      <div class="form-group">\n        <button type="submit" class="btn btn-primary">Guardar</button>\n      </div>\n    </form>\n  </div>\n</div>'),$templateCache.put("assets/views/maintenance/measureProcesses.html",'<div class="row">\n  <div ncy-breadcrumb="ncy-breadcrumb"></div>\n  <div class="condos-container col-sm-4 col-lg-4">\n    <div class="panel panel-success">\n      <div class="panel-heading">Proceso de medición Actual</div>\n      <div class="panel-body">\n        <div class="col-xs-12">\n          <button ng-if="measureProcesses.closed" ng-click="measureProcesses.initProcess()" class="btn btn-default">Iniciar Proceso</button>\n          <button ng-if="!measureProcesses.closed" ng-click="measureProcesses.closeProcess()" class="btn btn-default">Cerrar Proceso</button>\n        </div>\n        <div class="parameters-container col-xs-12">\n          <h4>Parámetros Actuales</h4><br>\n          <div class="row">\n            <div class="col-xs-7">\n              <label>Cargo Fijo:</label>\n            </div>\n            <div class="col-xs-5">\n              <label ng-bind="measureProcesses.chargeparameters.fixed"></label>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-xs-7">\n              <label>Valor m3:</label>\n            </div>\n            <div class="col-xs-5">\n              <label>{{measureProcesses.chargeparameters.normal_price}}</label>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-xs-7">\n              <label>Sobreconsumo:</label>\n            </div>\n            <div class="col-xs-5">\n              <label>{{measureProcesses.chargeparameters.over_consumption_price}}</label>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-xs-7">\n              <label>Iniciado:</label>\n            </div>\n            <div class="col-xs-5">\n              <label>---</label>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-xs-7">\n              <label>Cerrado:</label>\n            </div>\n            <div class="col-xs-5">\n              <label>---</label>\n            </div>\n          </div><a ui-sref="measures.changechargeparameters" class="btn btn-xs btn-primary"><i class="fa fa-cogs"></i>  Cambiar Parámetros</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="plots-list col-sm-8 col-lg-6">\n    <table class="table table-hover table-striped">\n      <thead>\n        <tr>\n          <th class="col-xs-3">Cargo Fijo</th>\n          <th class="col-xs-2">Valor m3</th>\n          <th class="col-xs-3">Sobreconsumo</th>\n          <th class="col-xs-4">Estado</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat="process in measureProcesses.measureProcesses track by process.id">\n          <td ng-bind="process.fixed"></td>\n          <td ng-bind="process.normal_price"></td>\n          <td ng-bind="process.over_consumption_price"></td>\n          <td ng-bind="process.status"></td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n\n'),$templateCache.put("assets/views/meters/createmeter.html",'<div ncy-breadcrumb=""></div>\n<div class="container users-container">\n  <h3>Agregar medidor</h3>\n  <hr>\n  <form name="createmeterform" ng-submit="createmeter.createmeter(createmeter.meter)" class="form">\n    <div class="form-group">\n      <label>Número del medidor:</label>\n      <input type="text" name="number" ng-model="createmeter.meter.number" placeholder="Numero del medidor" required="required" class="form-control">\n    </div>\n    <div ng-messages="createmeterform.name.$error" ng-if="createmeterform.name.$touched" role="alert">\n      <div ng-message="required" class="form-validation"><small class="text-warning"><b>Campo requerido</b> </small></div>\n    </div>\n    <div class="form-group">\n      <label>Estado:</label>\n      <select ng-options="status.value as status.label for status in createmeter.meterstatus" ng-model="createmeter.selectedstatus" class="form-control"></select>\n    </div>\n    <div ng-messages="createmeterform.name.$error" ng-if="createmeterform.name.$touched" role="alert">\n      <div ng-message="required" class="form-validation"><small class="text-warning"><b>Campo requerido</b> </small></div>\n    </div>\n    <div class="form-group">\n      <button type="submit" ng-disabled="createmeterform.$invalid" disabled="disabled" class="btn btn-default">Guardar</button>\n    </div>\n  </form>\n</div>'),$templateCache.put("assets/views/meters/meters.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Medidores</div>\n    <div class="panel-body">\n      <div class="row">\n        <div class="col-xs-4">\n          <div class="input-group"><span class="input-group-btn">\n              <button type="submit" class="btn btn-default"><i class="fa fa-fw fa-search"></i></button></span>\n            <input placeholder="Buscar..." type="text" class="form-control">\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-xs-6 col-xs-offset-6">\n          <div class="btn-group btn-group-justified">\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Copiar</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Excel</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">PDF</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Imprimir</button>\n            </div>\n          </div>\n        </div>\n      </div><br>\n      <table class="table table-condensed">\n        <thead>\n          <tr>\n            <th colspan="3" class="text-center">Propiedad</th>\n            <th colspan="3" class="text-center">Historial de consumo</th>\n            <th colspan="3" class="text-center">Medidor</th>\n          </tr>\n        </thead>\n        <thead>\n          <tr>\n            <th>N° Sitio</th>\n            <th>Ubicación</th>\n            <th>Propietario</th>\n            <th>Anterior</th>\n            <th>Actual</th>\n            <th>Consumo total</th>\n            <th>N° Medidor</th>\n            <th>Estado del medidor</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="meter in meters.metersList">\n            <td ng-bind="meter.nsitio"></td>\n            <td ng-bind="meter.ubicacion"></td>\n            <td ng-bind="meter.propietario"></td>\n            <td ng-bind="meter.anterior"></td>\n            <td ng-bind="meter.actual"></td>\n            <td ng-bind="meter.consumototal"></td>\n            <td ng-bind="meter.nmedidor"></td>\n            <td ng-bind="meter.estadomedidor"></td>\n          </tr>\n        </tbody>\n        <tfoot>\n          <tr>\n            <td colspan="9">\n              <nav>\n                <ul class="pagination pagination-sm">\n                  <li><a href="#" aria-label="Previous"><span aria-hidden="true">Anterior</span></a></li>\n                  <li> <a href="">1</a></li>\n                  <li><a href="#" aria-label="Next"><span aria-hidden="true">Siguiente</span></a></li>\n                </ul>\n              </nav>\n            </td>\n          </tr>\n        </tfoot>\n      </table>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/meters/unsetmeter.html",'<div class="row">\n  <div ncy-breadcrumb="ncy-breadcrumb"></div>\n</div>'),$templateCache.put("assets/views/navbar/navbar.html",'<nav class="navbar navbar-default navbar-fixed-top navbar-inverse">\n  <header>\n    <div class="logo">\n    </div>\n    <div class="title">\n      <h4>Sistema Administración Toma de agua</h4>\n    </div>\n    <div class="condos-select pull-right form-group">\n      <label>Condominio Actual</label>\n      <select ng-if="navbar.showCondos" ng-model="navbar.selectedCondo" ng-options="condo.name for condo in navbar.userLogged.condos_assigned " ng-change="navbar.changeCondo(navbar.selectedCondo.id)" class="form-control"></select>\n      <label ng-if="!navbar.showCondos" ng-bind="navbar.selectedCondo.name" class="form-control"></label>\n    </div>\n  </header>\n  <div class="container-fluid">\n    <div class="navbar-header">\n      <button type="button" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>\n    </div>\n    <div id="bs-example-navbar-collapse-1" class="collapse navbar-collapse">\n      <ul class="nav navbar-nav">\n        <li ng-class="{active: navbar.checkState(\'measures.home\')}"><a ui-sref="measures.home" title="Home"><i class="fa fa-lg fa-fw fa-home"></i>Home</a></li>\n        <li class="menu-item dropdown"><a ui-sref="measures.maintenance" data-toggle="dropdown" class="dropdown-toggle"><i class="fa fa-lg fa-fw fa-cogs"></i>Mantención<b class="caret"></b></a>\n          <ul class="dropdown-menu">\n            <li class="menu-item dropdown dropdown-submenu"><a data-toggle="dropdown" class="dropdown-toggle">Configuración</a>\n              <ul class="dropdown-menu">\n                <li class="menu-item"><a ui-sref="measures.measureProcesses">Mediciones</a></li>\n                <li class="menu-item"><a ui-sref="measures.assignsector">Asignar Sector</a></li>\n              </ul>\n            </li>\n            <li class="menu-item dropdown dropdown-submenu"><a data-toggle="dropdown" class="dropdown-toggle">Adm. Perfiles</a>\n              <ul class="dropdown-menu">\n                <li class="menu-item"><a ui-sref="measures.addusers">Crear lectores</a></li>\n                <li class="menu-item"><a ui-sref="measures.users">Listar lectores</a></li>\n              </ul>\n            </li>\n            <li class="menu-item dropdown"><a ui-sref="measures.changepassword" class="dropdown-toggle">Cambiar contraseña</a></li>\n          </ul>\n        </li>\n        <li ng-class="{active: navbar.checkState(\'measures.sectors\')}"><a ui-sref="measures.sectors"><i class="fa fa-lg fa-fw fa-bar-chart"></i>Parcelas</a></li>\n      </ul>\n    </div>\n  </div>\n</nav>'),$templateCache.put("assets/views/plots/plot.html",'<div ncy-breadcrumb="ncy-breadcrumb"></div>\n<div class="container"> \n  <div class="row">\n    <div class="col-xs-7">\n      <div class="panel-default">\n        <div class="panel-heading"><b>Datos Parcela</b></div>\n        <div class="panel-body">\n          <div class="form-group">\n            <label>Nº Parcela: </label><span ng-bind="plot.plotSelected.plot_number"> </span>\n          </div>\n          <div class="form-group">\n            <label>Nombre Propietario: </label><span ng-bind="plot.plotSelected.owner.name"> </span>\n          </div>\n          <div class="form-group">\n            <label>RUT Propietario: </label><span ng-bind="plot.plotSelected.owner.rut"></span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="col-xs-5">\n      <div class="panel-default">\n        <div class="panel-heading"><b>Medidores </b>\n        </div>\n        <div class="panel-body">\n          <table class="table table-condensed">\n            <thead>\n              <tr>\n                <th>Medidor</th>\n                <th>Opciones</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="meter in plot.plotSelected.meters track by meter.id">\n                <td>Medidor {{meter.number}}</td>\n                <td class="btn-group">\n                  <button ng-click="plot.goPlotMeasures(meter.id)" disabled="disabled" class="btn btn-default btn-xs"><i class="fa fa-bars fw"></i> Historial</button>\n                  <button ng-click="plot.goUnsetMeter(meter.id)" disabled="disabled" class="btn btn-danger btn-xs"><i class="fa fa-fw fa-remove"></i> Dar de baja</button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/plots/plotMeasures.html",'<div class="row">\n  <div ncy-breadcrumb="ncy-breadcrumb"></div>\n  <div class="plots-list col-sm-8 col-lg-6">\n    <table class="table table-hover table-striped">\n      <thead>\n        <tr>\n          <th class="col-xs-3">Valor Medido</th>\n          <th class="col-xs-2">Comentario</th>\n          <th class="col-xs-3">Usuario Medicion</th>\n          <th class="col-xs-4">Estado</th>\n        </tr>\n        <tbody>\n          <tr ng-repeat="measure in plotMeasures.plotMeasures.measures track by measure.id">\n            <td ng-bind="measure.value"></td>\n            <td ng-bind="measure.comment"></td>\n            <td ng-bind="measure.user"></td>\n            <td ng-bind="measure.status"></td>\n          </tr>\n        </tbody>\n      </thead>\n    </table>\n  </div>\n</div>'),$templateCache.put("assets/views/plots/plotsowners.html",'<div class="container">\n  <div ncy-breadcrumb="ncy-breadcrumb"></div>\n  <div class="row">\n    <div class="col-sm-6 form-inline">\n      <div class="form-group">\n        <label style="display:block">Condominio:</label>\n        <select ng-options="condo.id as condo.name for condo in plotsowners.condosList" ng-model="plotsowners.selectedCondoId" ng-change="plotsowners.loadSectors(plotsowners.selectedCondoId)" class="form-control"></select>\n      </div>\n      <div class="form-group">\n        <label style="display:block">Sector:</label>\n        <select ng-options="sector.id as sector.name for sector in plotsowners.sectorsList" ng-model="plotsowners.selectedSectorId" ng-change="plotsowners.loadPlots(plotsowners.selectedSectorId)" class="form-control"></select>\n      </div>\n    </div>\n    <div class="search-container col-sm-6">\n      <form name="searchPlot" role="search" ng-submit="plotsowners.searchPlot(plotsowners.searchModel)" class="form-inline">\n        <div class="input-group col-xs-12 add-on"> \n          <input name="inputSearch" ng-model="plotsowners.searchModel" ng-change="plotsowners.searchPlot(plotsowners.searchModel)" class="form-control">\n          <div class="input-group-btn">\n            <button type="submit" class="btn btn-default search-button"><i class="fa fa-search"></i></button>\n          </div>\n        </div>\n      </form>\n    </div>\n    <div class="row">\n      <div class="plots-list col-sm-12">\n        <table class="table table-hover table-striped table-condensed">\n          <thead>\n            <tr>\n              <th></th>\n              <th colspan="2" class="text-center">Dueño</th>\n            </tr>\n          </thead>\n          <thead>\n            <tr>\n              <th class="col-xs-2">N° propiedad</th>\n              <th class="col-xs-4">Nombre</th>\n              <th class="col-xs-4">RUT</th>\n              <th class="col-xs-2">Estado</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr ng-repeat="plot in plotsowners.plotsList track by plot.id">\n              <td ng-bind="plot.id"></td>\n              <td ng-bind="plot.owner"></td>\n              <td ng-bind=""></td>\n              <td> \n                <div class="btn-group"><a ng-click="plotsowners.plotGo(plot.id)" class="btn btn-info btn-xs">Ver</a><a ui-sref="measures.setplotowners({id:plot.id})" ng-if="plot.owner" class="btn btn-primary btn-xs">Cambiar dueño</a><a ui-sref="measures.setplotowners({id:plot.id})" ng-if="!plot.owner" class="btn btn-primary btn-xs">Ingresar dueño</a></div>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/plots/setplotowners.html",'<div class="container">\n  <div ncy-breadcrumb="ncy-breadcrumb"></div>\n  <form class="form">\n    <div class="form-group">\n      <label>Numero</label>\n      <input value="{{setplotsowners.plot.plot_number}}" disabled="disabled" class="form-control">\n    </div>\n    <div class="form-group">\n      <label>Dueño</label>\n      <ui-select ng-model="setplotsowners.selected.value">\n        <ui-select-match><span ng-bind="$select.selected.nombre"></span></ui-select-match>\n        <ui-select-choices repeat="item in (setplotsowners.plotsOwners | filter: $select.search) track by item.rut">\n          <div ng-bind-html="item.nombre | highlight: $select.search"></div><small>RUT: <span><b ng-bind-html="\'\'+item.rut | highlight: $select.search"></b></span></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </form>\n</div>'),$templateCache.put("assets/views/sectors/sectors.html",'<div ncy-breadcrumb="ncy-breadcrumb"></div>\n<div class="container"> \n  <div class="row">\n    <div class="col-xs-5">\n      <div class="form-group">\n        <label>Seleccione Sector</label>\n        <select ng-options="sector.id as sector.name for sector in sectors.sectorsList" ng-model="sectors.selectedSectorId" ng-change="sectors.loadPlots(sectors.selectedSectorId)" class="form-control"></select>\n      </div>\n    </div>\n    <div class="col-xs-7">\n      <form name="searchPlot" role="search" ng-submit="sectors.searchPlot(sectors.searchModel)" class="form-inline">\n        <label>Buscar una parcela</label>\n        <div class="input-group col-xs-12 add-on"> \n          <input name="inputSearch" ng-model="sectors.searchModel" ng-change="sectors.searchPlot(sectors.searchModel)" class="form-control">\n          <div class="input-group-btn">\n            <button type="submit" class="btn btn-default search-button"><i class="fa fa-search"></i></button>\n          </div>\n        </div>\n      </form>\n    </div>\n    <div class="plots-list">\n      <table class="table table-hover table-striped table-condensed">\n        <thead>\n          <tr>\n            <th class="col-xs-2">Número propiedad</th>\n            <th class="col-xs-4">Valor última medición</th>\n            <th class="col-xs-4">Lectura hecha por</th>\n            <th class="col-xs-2"></th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="plot in sectors.plotsList track by plot.id">\n            <td ng-bind="plot.plot_number"></td>\n            <td ng-bind="plot.meters[0].last_measure.value"></td>\n            <td ng-bind="plot.meters[0].last_measure.last_measurer"></td>\n            <td> <a ng-click="sectors.plotGo(plot.id)" class="btn btn-info btn-xs"> <i class="fa fa-binoculars fa-fw"></i> Ver</a></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>'),$templateCache.put("assets/views/users/addedit.html",'<div ncy-breadcrumb=""></div>\n<div class="container users-container">\n  <h3>Agregar usuario</h3>\n  <hr>\n  <form name="addeditform" ng-submit="addeditusers.addedit(addeditusers.user)" class="form">\n    <div class="form-group">\n      <label>Nombre:</label>\n      <input type="text" name="name" ng-model="addeditusers.user.name" ng-minlength="4" placeholder="Nombre del usuario" required="required" class="form-control">\n    </div>\n    <div ng-messages="addeditform.name.$error" ng-if="addeditform.name.$touched" role="alert">\n      <div ng-message="required" class="form-validation"><small class="text-warning"><b>Campo requerido</b> </small></div>\n      <div ng-message="minlength" class="form-validation"><small class="text-warning"><b>Nombre demasiado corto</b></small></div>\n    </div>\n    <div class="form-group">\n      <label>Rut:</label>\n      <input type="text" name="rut" ng-model="addeditusers.user.rut" ng-model-options="{ updateOn: \'blur\' }" gp-rut-validator="gp-rut-validator" placeholder="rut del usuario" required="required" class="form-control">\n    </div>\n    <div ng-messages="addeditform.rut.$error" ng-if="addeditform.rut.$touched" role="alert">\n      <div ng-message="required" class="form-validation"> <small class="text-warning"><b>Campo requerido</b></small></div>\n      <div ng-message="rutInvalid" class="form-validation"><small class="text-warning"><b>Rut inválido</b></small></div>\n    </div>\n    <div class="form-group">\n      <label>Usuario:</label>\n      <input type="text" name="email" ng-model="addeditusers.user.email" placeholder="ej: usuario@riomar.cl" required="required" class="form-control">\n    </div>\n    <div ng-messages="addeditform.email.$error" ng-if="addeditform.email.$touched" role="alert">\n      <div ng-message="required" class="form-validation"> <small class="text-warning"><b>Campo requerido</b></small></div>\n      <div ng-message="rutInvalid" class="form-validation"><small class="text-warning"><b>Rut inválido</b></small></div>\n    </div>\n    <div class="form-group">\n      <label>Contraseña:</label>\n      <input type="password" name="password" ng-model="addeditusers.user.password" placeholder="Contaseña del nuevo usuario" required="required" class="form-control">\n    </div>\n    <div ng-messages="addeditform.password.$error" ng-if="addeditform.password.$touched" role="alert">\n      <div ng-message="required" class="form-validation"> <small class="text-warning"><b>Campo requerido</b></small></div>\n      <div ng-message="rutInvalid" class="form-validation"><small class="text-warning"><b>Rut inválido</b></small></div>\n    </div>\n    <div class="form-group">\n      <button type="submit" ng-disabled="addeditform.$invalid" class="btn btn-default">Guardar</button>\n    </div>\n  </form>\n</div>'),$templateCache.put("assets/views/users/users.html",'<div ncy-breadcrumb=""></div>\n<div class="container">\n  <div class="panel panel-success">\n    <div class="panel-heading">Listar Lector</div>\n    <div class="panel-body">\n      <div class="row">\n        <div class="col-xs-4">\n          <div class="input-group"><span class="input-group-btn">\n              <button type="submit" class="btn btn-default"><i class="fa fa-fw fa-search"></i></button></span>\n            <input placeholder="Buscar..." type="text" class="form-control">\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-xs-6 col-xs-offset-6">\n          <div class="btn-group btn-group-justified">\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Copiar</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Excel</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">PDF</button>\n            </div>\n            <div role="group" class="btn-group">\n              <button type="button" class="btn btn-default">Imprimir</button>\n            </div>\n          </div>\n        </div>\n      </div><br>\n      <table class="table table-condensed">\n        <thead>\n          <tr>\n            <th>RUN</th>\n            <th>Nombres</th>\n            <th>Usuario</th>\n            <th>Sector asignado</th>\n            <th>Opciones</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="user in users.usersList">\n            <td ng-bind="user.rut"></td>\n            <td ng-bind="user.name"></td>\n            <td ng-bind="user.email"></td>\n            <td ng-bind=""></td>\n            <td ng-bind=""></td>\n            <td ng-bind=""></td>\n            <td class="users-options">\n              <div role="toolbar" class="btn-group btn-group-xs"><a ui-sref="measures.addedit/{{user.user_id}}" class="btn btn-primary"> <i class="fa fa-plus fa-fw"></i></a><a ui-sref="measures.editpassword/{{user.user_id}}" class="btn btn-info"><i class="fa fa-cog fa-fw"></i></a><a ui-sref="measures.deleteuser/{{user.user_id}}" class="btn btn-primary"><i class="fa fa-trash fa-fw"></i></a></div>\n            </td>\n          </tr>\n        </tbody>\n        <tfoot>\n          <tr>\n            <td colspan="9">\n              <nav>\n                <ul class="pagination pagination-sm">\n                  <li><a href="#" aria-label="Previous"><span aria-hidden="true">Anterior</span></a></li>\n                  <li> <a href="">1</a></li>\n                  <li><a href="#" aria-label="Next"><span aria-hidden="true">Siguiente</span></a></li>\n                </ul>\n              </nav>\n            </td>\n          </tr>\n        </tfoot>\n      </table>\n    </div>\n  </div>\n</div>')}]),function(){"use strict";function Controller($state,UserResolve,UsersService){function addedit(_user){_user&&UsersService.createUser(_user).then(function(){$state.go("measures.users")})}var vm=this;vm.addedit=addedit,vm.user=angular.copy(UserResolve)}angular.module("MedicionAguaAdmin").controller("AddEditUsersController",Controller),Controller.$inject=["$state","UserResolve","UsersService"]}(),function(){"use strict";function Controller($rootScope,$filter,$timeout,UsersResolve){var vm=this;vm.usersList=angular.copy(UsersResolve)}angular.module("MedicionAguaAdmin").controller("UsersController",Controller),Controller.$inject=["$rootScope","$filter","$timeout","UsersResolve"]}(),function(){"use strict";function service($q,$http,APP_SETTINGS,$resource,AuthService){function resolveUser(response){return response.toJSON()}function getUsers(){var selectedCondo=AuthService.getUser().condoSelected;return self.usersResource.query({condoId:selectedCondo.id}).$promise}function createUser(_user){var selectedCondo=AuthService.getUser().condoSelected;_user.condo_id=selectedCondo.id,console.log(_user),_user={user:_user};var user=new self.usersResource(_user);return user.$save({condoId:selectedCondo.id}).then(resolveUser)}var self=this;self.usersResource=$resource(APP_SETTINGS.BASE_URL+"/condos/:condoId/users/:id",{id:"@id",condoId:"@condoId"}),self.getUsers=getUsers,self.createUser=createUser}angular.module("MedicionAguaAdmin").service("UsersService",service),service.$inject=["$q","$http","APP_SETTINGS","$resource","AuthService"]}(),function(){"use strict";function configFn($stateProvider,APP_SETTINGS){$stateProvider.state("measures.users",{url:"users",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/users/users.html",controller:"UsersController",controllerAs:"users",resolve:{UsersResolve:["UsersService",function(UsersService){return UsersService.getUsers()}]}}},ncyBreadcrumb:{label:"Usuarios"}}).state("measures.addusers",{url:"adduser",views:{navbar:APP_SETTINGS.NAVBAR_SETTINGS,main:{templateUrl:"assets/views/users/addedit.html",controller:"AddEditUsersController",controllerAs:"addeditusers",resolve:{UserResolve:["$stateParams",function($stateParams){return{name:"",rut:"",email:"",password:""}}]}}},ncyBreadcrumb:{label:"Agregar usuario"}})}angular.module("MedicionAguaAdmin").config(configFn),configFn.$inject=["$stateProvider","APP_SETTINGS"]}();
